<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ph√¢n t√≠ch t·ª´ v√† c√¢u ti·∫øng Anh</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="src/styles/main.css" />
</head>
<body class="bg-gray-100">
    <div id="app" class="container mx-auto p-4">
        <h1 class="text-3xl font-bold mb-4">Ph√¢n t√≠ch t·ª´ v√† c√¢u ti·∫øng Anh</h1>

        <div class="mb-4">
            <input v-model="newWord" type="text" class="border p-2" placeholder="Nh·∫≠p t·ª´ ho·∫∑c c√¢u m·ªõi" />
            <button @click="sendWordToServer" class="bg-blue-500 text-white p-2 ml-2" :disabled="isSending">
                {{ isSending ? 'ƒêang g·ª≠i...' : 'G·ª≠i' }}
            </button>
        </div>

        <button @click="toggleScanning" class="bg-blue-500 text-white p-2 mb-2 flex items-center">
            {{ isScanning ? 'D·ª´ng qu√©t' : 'B·∫Øt ƒë·∫ßu qu√©t' }}
            <span v-if="isScanning" class="ml-2 animate-pulse">üîç</span>
        </button>

        <div v-if="isScanning" class="text-green-600 mb-2">
            Ch·∫ø ƒë·ªô qu√©t ƒëang ho·∫°t ƒë·ªông. H√£y ch·ªçn t·ª´ ƒë·ªÉ xem ƒë·ªãnh nghƒ©a.
        </div>

        <div v-if="dataType === 'word'">
            <div v-for="(typeDefinitions, type) in definitions" :key="type" class="mb-6">
                <h2 class="text-2xl font-bold mb-2">{{ type }}</h2>
                <div v-for="(definition, key) in typeDefinitions" :key="key" class="mb-4">
                    <h3 class="text-xl font-semibold mb-2">{{ key }}</h3>
                    <div v-if="definition.examples.VI.length" class="mb-2">
                        <h4 class="text-lg font-medium">V√≠ d·ª• ti·∫øng Vi·ªát:</h4>
                        <ul class="list-disc list-inside">
                            <li v-for="(example, index) in definition.examples.VI" :key="index"
                                @click="handleWordClick(example, index)" :class="getWordClass(example, index)">
                                {{ ' ' + example }}
                            </li>
                        </ul>
                    </div>
                    <div v-if="definition.examples.EN.length" class="mb-2">
                        <h4 class="text-lg font-medium">V√≠ d·ª• ti·∫øng Anh:</h4>
                        <ul class="list-disc list-inside">
                            <li v-for="(example, index) in definition.examples.EN" :key="index"
                                @click="handleWordClick(example, index)" :class="getWordClass(example, index)">
                                {{ ' ' + example }}
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div v-if="dataType === 'sentence'">
            <div v-for="(value, key) in sentenceStructure" :key="key" class="mb-4">
                <h2 class="text-2xl font-bold mb-2">{{ key }}</h2>
                <div v-if="typeof value === 'string'" class="sentence-container">
                    <template v-for="(word, index) in value.split(' ')" :key="index">
                        <span @click="handleWordClick(word, index, key)"
                            :class="getWordClass(word, index, key)"
                            :data-word-index="index"
                            :data-sentence-type="key">{{ word }}</span>{{ ' ' }}
                    </template>
                </div>
                <ul v-else-if="Array.isArray(value)" class="list-disc list-inside">
                    <li v-for="(item, itemIndex) in value" :key="itemIndex">
                        <template v-for="(word, wordIndex) in item.split(' ')" :key="wordIndex">
                            <span @click="handleWordClick(word, wordIndex, key, itemIndex)"
                                :class="getWordClass(word, wordIndex, key, itemIndex)"
                                :data-word-index="wordIndex"
                                :data-sentence-type="key"
                                :data-item-index="itemIndex">{{ word }}</span>{{ ' ' }}
                        </template>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div id="scanningTooltip" class="fixed bg-white p-4 shadow-lg rounded-lg max-w-md" style="display: none"></div>

    <script src="https://cdn.jsdelivr.net/npm/vue@3.2.31/dist/vue.global.prod.js"></script>
    <script type="module" src="src/App.js"></script>
</body>
</html>
